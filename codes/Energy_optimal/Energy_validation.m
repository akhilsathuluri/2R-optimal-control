%proving the energy is constant through work energy principle
l1 = 0.4;
l2  = 0.25;
r2 = 0.125;
m1 = 15;
m2 = 6;
m3 = 0.1;
I1 = 1.6;
I2 = 0.431;
r1 = l1/2;
N = 200;
E = zeros(1,N);
W = zeros(1,N);
diff = zeros(1,N);
diff2 = zeros(1,N);
for i=2:N
E(i) = 0.5E0.*y(2,i).^2.*I1+0.5E0.*(y(2,i).*(y(2,i)+y(4,i))+y(4,i).*(y(2,i)+y(4,i))).*I2+ ...
  0.5E0.*y(2,i).*m1.*(y(2,i).*r1.^2.*cos(y(1,i)).^2+y(2,i).*r1.^2.*sin(y(1,i)).^2)+ ...
  0.5E0.*m3.*(y(4,i).*(l2.*cos(y(1,i)+y(3,i)).*(y(4,i).*l2.*cos(y(1,i)+y(3,i))+y(2,i).*(l1.* ...
  cos(y(1,i))+l2.*cos(y(1,i)+y(3,i))))+(-1).*l2.*sin(y(1,i)+y(3,i)).*((-1).*y(4,i).*l2.* ...
  sin(y(1,i)+y(3,i))+y(2,i).*((-1).*l1.*sin(y(1,i))+(-1).*l2.*sin(y(1,i)+y(3,i)))))+y(2,i).*(( ...
  l1.*cos(y(1,i))+l2.*cos(y(1,i)+y(3,i))).*(y(4,i).*l2.*cos(y(1,i)+y(3,i))+y(2,i).*(l1.*cos( ...
  y(1,i))+l2.*cos(y(1,i)+y(3,i))))+((-1).*l1.*sin(y(1,i))+(-1).*l2.*sin(y(1,i)+y(3,i))).*(( ...
  -1).*y(4,i).*l2.*sin(y(1,i)+y(3,i))+y(2,i).*((-1).*l1.*sin(y(1,i))+(-1).*l2.*sin(y(1,i)+ ...
  y(3,i))))))+0.5E0.*m2.*(y(4,i).*(r2.*cos(y(1,i)+y(3,i)).*(y(4,i).*r2.*cos(y(1,i)+y(3,i))+ ...
  y(2,i).*(l1.*cos(y(1,i))+r2.*cos(y(1,i)+y(3,i))))+(-1).*r2.*sin(y(1,i)+y(3,i)).*((-1).* ...
  y(4,i).*r2.*sin(y(1,i)+y(3,i))+y(2,i).*((-1).*l1.*sin(y(1,i))+(-1).*r2.*sin(y(1,i)+y(3,i)))) ...
  )+y(2,i).*((l1.*cos(y(1,i))+r2.*cos(y(1,i)+y(3,i))).*(y(4,i).*r2.*cos(y(1,i)+y(3,i))+y(2,i).*( ...
  l1.*cos(y(1,i))+r2.*cos(y(1,i)+y(3,i))))+((-1).*l1.*sin(y(1,i))+(-1).*r2.*sin(y(1,i)+ ...
  y(3,i))).*((-1).*y(4,i).*r2.*sin(y(1,i)+y(3,i))+y(2,i).*((-1).*l1.*sin(y(1,i))+(-1).* ...
  r2.*sin(y(1,i)+y(3,i))))));

W(i) = trapz(u(1:i)',y(1,1:i))+trapz(u(201:200+i)',y(1,1:i));

diff(i) = W(i)-E(i);
%diff2(i) = E(i)+W(i);
end
plot(diff);




