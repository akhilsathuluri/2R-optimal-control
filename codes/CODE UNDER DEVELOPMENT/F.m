function [BigF,H]= F(x1,x2,x3,x4,p1,p2,p3,p4,u1,u2)
m1 = 29.58;
m2 = 15;
l1 = 0.4;
l2 = 0.25;
I1 = 0.416739;
I2 = 0.205625;
M1 = 25;
M2 = 9;
ma = 0;
mb = 6;
c1 = 0.25*m1*l1^2 + I1 + (m2 + ma + mb)*l1^2;
c2 = m2*0.25*l2^2 + I2 + mb*l2^2;
c3 = (m2*l2*0.5 + mb*l2)*l1;
a11 = c1 + c2 + 2*c3*cos(x3);
a12 = c2 +c3*cos(x3);
a13 = c3*sin(x3);
a22 = c2;
del = a11*a22 - a12^2;
c11 = 0;
c12 = 0;
c21 = a22/del;
c22 = -a12/del;
c31 = 0;
c32 = 0;
c41 = -a12/del;
c42 = a11/del;
a1 = x2;
a2 = (a13/del)*(a22*(2*x2+x4)*x4+a12*x2^2);
a3 = x4;
a4 = (-a13/del)*(a12*(2*x2+x4)*x4+a11*x2^2);


fx1 = a1+c11*u1+c12*u2;
fx2 = a2+c21*u1+c22*u2;
fx3 = a3+c31*u1+c32*u2;
fx4 = a4+c41*u1+c42*u2;
fp1 = 0;
fp2 = -p1-(1.35*p2*(1.63*x4 + 2*x2*(0.815 + 1.35*cos(x3)))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) +(1.35*p4*(2*x4*(0.815 + 1.35*cos(x3)) + 2*x2*(5.774939000000002 + 2.7*cos(x3)))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2);
fp3 = (-p2)*((1.35*cos(x3)*(0.815*x4*(2*x2 + x4) + x2^2*(0.815 + 1.35*cos(x3))))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) - (2.9706750000000004*u1*cos(x3)*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2 + (3.6450000000000005*u2*cos(x3)*(0.815 + 1.35*cos(x3))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2 + (1.35*u2*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) - (1.8225000000000002*x2^2*sin(x3)^2)/(4.042350285000001 -1.8225000000000002*cos(x3)^2) - (4.920750000000001*cos(x3)*(0.815*x4*(2*x2 + x4) + x2^2*(0.815 + 1.35*cos(x3)))*sin(x3)^2)/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2) - p4*(-((1.35*cos(x3)*(x4*(2*x2 + x4)*(0.815 + 1.35*cos(x3)) + x2^2*(5.774939000000002 + 2.7*cos(x3))))/(4.042350285000001 -1.8225000000000002*cos(x3)^2)) + (3.6450000000000005*u1*cos(x3)*(0.815 + 1.35*cos(x3))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2 - (3.6450000000000005*u2*cos(x3)*(5.774939000000002 + 2.7*cos(x3))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2 + (1.35*u1*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) -  (2.7*u2*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) + (4.920750000000001*cos(x3)*(x4*(2*x2 + x4)*(0.815 + 1.35*cos(x3)) + x2^2*(5.774939000000002 + 2.7*cos(x3)))*sin(x3)^2)/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2 - (1.35*sin(x3)*(-2.7*x2^2*sin(x3) - 1.35*x4*(2*x2 + x4)*sin(x3)))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2));
fp4 = -p3 - (1.35*p2*(0.815*x4 + 0.815*(2*x2 + x4))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) + (1.35*p4*(x4*(0.815 + 1.35*cos(x3)) + (2*x2 + x4)*(0.815 + 1.35*cos(x3)))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2);       
BigF = [fx1;fx2;fx3;fx4;fp1;fp2;fp3;fp4];
H = -1+p1*(a1+c11*u1+c12*u2)+p2*(a2+c21*u1+c22*u2)+p3*(a3+c31*u1+c32*u2)+p4*(a4+c41*u1+c42*u2);
end