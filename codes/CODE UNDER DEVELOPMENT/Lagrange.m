function L = Lagrange(x1,x2,x3,x4,p1,p2,p3,p4,u1,u2)

L(1,:) = [1, 0, 0, 0, 0, 0, 0, 0];
L(2,:) = [0, 1, 0, 0, 0, 0, 0, 0];
L(3,:) = [0, 0, 1, 0, 0, 0, 0, 0];
L(4,:) = [0, 0, 0, 1, 0, 0, 0, 0];

L(5,1) = 0;
L(5,2) = p1 + (1.35*p2*(1.63*x4 + 2*x2*(0.815 + 1.35*cos(x3)))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) - (1.35*p4*(2*x4*(0.815 + 1.35*cos(x3)) + 2*x2*(5.774939000000002 + 2.7*cos(x3)))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2);
L(5,3) = p2*((1.35*cos(x3)*(0.815*x4*(2*x2 + x4) + x2^2*(0.815 + 1.35*cos(x3))))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) - (2.9706750000000004*u1*cos(x3)*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2 + (3.6450000000000005*u2*cos(x3)*(0.815 + 1.35*cos(x3))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2 + (1.35*u2*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) - (1.8225000000000002*x2^2*sin(x3)^2)/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) - (4.920750000000001*cos(x3)*(0.815*x4*(2*x2 + x4) + x2^2*(0.815 + 1.35*cos(x3)))*sin(x3)^2)/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2) + p4*(-((1.35*cos(x3)*(x4*(2*x2 + x4)*(0.815 + 1.35*cos(x3)) + x2^2*(5.774939000000002 + 2.7*cos(x3))))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)) + (3.6450000000000005*u1*cos(x3)*(0.815 + 1.35*cos(x3))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2 - (3.6450000000000005*u2*cos(x3)*(5.774939000000002 + 2.7*cos(x3))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2 + (1.35*u1*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) - (2.7*u2*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) + (4.920750000000001*cos(x3)*(x4*(2*x2 + x4)*(0.815 + 1.35*cos(x3)) + x2^2*(5.774939000000002 + 2.7*cos(x3)))*sin(x3)^2)/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)^2 - (1.35*sin(x3)*(-2.7*x2^2*sin(x3) - 1.35*x4*(2*x2 + x4)*sin(x3)))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2));
L(5,4) = p3 + (1.35*p2*(0.815*x4 + 0.815*(2*x2 + x4))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) - (1.35*p4*(x4*(0.815 + 1.35*cos(x3)) + (2*x2 + x4)*(0.815 + 1.35*cos(x3)))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2);
L(5,5) = x2;
L(5,6) = (0.815*u1)/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) - (u2*(0.815 + 1.35*cos(x3)))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) + (1.35*(0.815*x4*(2*x2 + x4) + x2^2*(0.815 + 1.35*cos(x3)))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2);
L(5,7) = x4;
L(5,8) = -((u1*(0.815 + 1.35*cos(x3)))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2)) + (u2*(5.774939000000002 + 2.7*cos(x3)))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2) - (1.35*(x4*(2*x2 + x4)*(0.815 + 1.35*cos(x3)) + x2^2*(5.774939000000002 + 2.7*cos(x3)))*sin(x3))/(4.042350285000001 - 1.8225000000000002*cos(x3)^2);

end